# ===========================================
# CONFIGURACIÓN DE PRODUCCIÓN - FACTURAaaS
# ===========================================
# Activar con: --spring.profiles.active=prod
# o variable: SPRING_PROFILES_ACTIVE=prod

# Server Configuration
server.port=${PORT:8080}

# Database Configuration (PostgreSQL)
# Opción 1: URL completa con credenciales incluidas
spring.datasource.url=${DATABASE_URL}

# Opción 2: URL y credenciales separadas
#spring.datasource.url=${DATABASE_URL}
#spring.datasource.username=${DATABASE_USERNAME}
#spring.datasource.password=${DATABASE_PASSWORD}
#spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate (producción - solo validación, NO auto-crear)
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# =====================================================
# Inicialización de BD con scripts SQL
# =====================================================
# Spring Boot busca automáticamente en src/main/resources/:
#   - schema-postgresql.sql  → Creación de tablas (DDL)
#   - data-postgresql.sql    → Datos iniciales (DML)
#
# Orden de ejecución:
#   1. schema-postgresql.sql (si existe)
#   2. data-postgresql.sql (si existe)
#   3. AdminInitializer.java (CommandLineRunner)
# =====================================================
spring.sql.init.mode=always
spring.sql.init.platform=postgresql
spring.sql.init.continue-on-error=true

# Alternativa: especificar rutas explícitas (opcional)
# spring.sql.init.schema-locations=classpath:schema-postgresql.sql
# spring.sql.init.data-locations=classpath:data-postgresql.sql

# H2 Console deshabilitada en producción
spring.h2.console.enabled=false

# JWT Configuration (desde variables de entorno)
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:86400000}

# CORS Configuration (desde variable de entorno)
cors.allowed-origins=${CORS_ALLOWED_ORIGINS}

# Admin inicial (contraseña desde variable de entorno)
admin.password=${ADMIN_PASSWORD}

# Logging (menos verboso en producción)
logging.level.root=WARN
logging.level.es.uvigo.mei.facturaaas=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN

# Actuator Endpoints (restringido en producción)
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when_authorized
management.endpoint.health.probes.enabled=true
